<div class="material-contact-form-container">
  <!-- Loading State -->
  <div *ngIf="loading" class="loading-card">
    <mat-spinner [diameter]="50"></mat-spinner>
    <p>Loading tenant information...</p>
  </div>

  <!-- Error State -->
  <div *ngIf="error && !loading" class="error-card">
    <mat-icon class="error-icon">error_outline</mat-icon>
    <p>{{ error }}</p>
  </div>

  <!-- Success State -->
  <div *ngIf="success && !loading" class="success-card">
    <mat-icon class="success-icon">check_circle</mat-icon>
    <h2>Thank you!</h2>
    <p *ngIf="tenantConfig">{{ tenantConfig.post_submit_message }}</p>
    <button mat-raised-button (click)="success = false">Submit Another Message</button>
  </div>

  <!-- Form State -->
  <mat-card *ngIf="!loading && !success && tenantConfig">
    <!-- Title and Subtitle Section -->
    <mat-card-header class="header-section">
      <mat-card-title>{{ tenantConfig.business_name }}</mat-card-title>
      <mat-card-subtitle>{{ tenantConfig.intro_text }}</mat-card-subtitle>
    </mat-card-header>

    <mat-card-content>
      <div class="content-layout">
        <!-- Left Panel - Business Info (1/3) -->
        <div class="info-panel">
          <h3>Get in Touch</h3>

          <div class="info-item" *ngIf="tenantConfig?.business_address_1">
            <mat-icon>location_on</mat-icon>
            <div>
              <strong>Address</strong>
              <p>{{ tenantConfig.business_address_1 }}<br>
              <span *ngIf="tenantConfig.business_address_2">{{ tenantConfig.business_address_2 }}<br></span>
              {{ tenantConfig.business_city }}, {{ tenantConfig.business_state }} {{ tenantConfig.business_zip }}</p>
            </div>
          </div>

          <div class="info-item" *ngIf="tenantConfig?.business_phone">
            <mat-icon>phone</mat-icon>
            <div>
              <strong>Phone</strong>
              <p><a [href]="'tel:' + tenantConfig.business_phone">{{ tenantConfig.business_phone }}</a></p>
            </div>
          </div>

          <div class="info-item" *ngIf="tenantConfig?.notify_on_submit">
            <mat-icon>email</mat-icon>
            <div>
              <strong>Email</strong>
              <p><a [href]="'mailto:' + tenantConfig.notify_on_submit">{{ tenantConfig.notify_on_submit }}</a></p>
            </div>
          </div>

          <div class="info-item" *ngIf="tenantConfig?.business_web_url">
            <mat-icon>language</mat-icon>
            <div>
              <strong>Website</strong>
              <p><a [href]="tenantConfig.business_web_url" target="_blank" rel="noopener noreferrer">{{ tenantConfig.business_web_url }}</a></p>
            </div>
          </div>
        </div>

        <!-- Right Panel - Contact Form (2/3) -->
        <div class="form-panel">
          <form [formGroup]="contactForm" (ngSubmit)="onSubmit()">
            <!-- First Name / Last Name Row -->
            <div class="form-row">
              <mat-form-field appearance="outline">
                <mat-label>First Name</mat-label>
                <input matInput formControlName="firstName" placeholder="Enter your first name" required>
                <mat-error *ngIf="contactForm.get('firstName')?.hasError('required')">
                  First name is required
                </mat-error>
              </mat-form-field>

              <mat-form-field appearance="outline">
                <mat-label>Last Name</mat-label>
                <input matInput formControlName="lastName" placeholder="Enter your last name" required>
                <mat-error *ngIf="contactForm.get('lastName')?.hasError('required')">
                  Last name is required
                </mat-error>
              </mat-form-field>
            </div>

            <!-- Email / Phone Row -->
            <div class="form-row">
              <mat-form-field appearance="outline">
                <mat-label>Email</mat-label>
                <input matInput type="email" formControlName="email" placeholder="your@email.com" required>
                <mat-error *ngIf="contactForm.get('email')?.hasError('required')">
                  Email is required
                </mat-error>
                <mat-error *ngIf="contactForm.get('email')?.hasError('email')">
                  Please enter a valid email
                </mat-error>
              </mat-form-field>

              <mat-form-field appearance="outline">
                <mat-label>Phone</mat-label>
                <input matInput type="tel" formControlName="phone" placeholder="(555) 123-4567" required>
                <mat-error *ngIf="contactForm.get('phone')?.hasError('required')">
                  Phone number is required
                </mat-error>
              </mat-form-field>
            </div>

            <!-- Reason for Contact Row -->
            <div class="form-row-full">
              <mat-form-field appearance="outline">
                <mat-label>Reason for Contact</mat-label>
                <input matInput formControlName="reason" placeholder="What is this regarding?" required>
                <mat-error *ngIf="contactForm.get('reason')?.hasError('required')">
                  Reason is required
                </mat-error>
              </mat-form-field>
            </div>

            <!-- Message Row -->
            <div class="form-row-full">
              <mat-form-field appearance="outline">
                <mat-label>Message</mat-label>
                <textarea 
                  matInput 
                  formControlName="message" 
                  placeholder="Tell us more about your inquiry..."
                  rows="5"
                ></textarea>
              </mat-form-field>
            </div>

            <!-- Error Display -->
            <div *ngIf="error" class="form-error-message">
              <mat-icon>warning</mat-icon>
              {{ error }}
            </div>

            <!-- Submit Button -->
            <div class="form-actions">
              <button
                mat-raised-button
                color="primary"
                type="submit"
                [disabled]="!contactForm.valid || submitting"
              >
                <mat-icon *ngIf="!submitting">send</mat-icon>
                <mat-spinner *ngIf="submitting" diameter="20" class="button-spinner"></mat-spinner>
                {{ submitting ? 'Sending...' : 'Send' }}
              </button>
            </div>
          </form>
        </div>
      </div>
    </mat-card-content>
  </mat-card>
</div>
